{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapMutations, mapGetters } from \"vuex\";\nimport axios from 'axios';\nexport default {\n  name: \"AccountPage\",\n  data() {\n    return {\n      isEditing: false,\n      isLoading: false,\n      formData: {\n        firstName: \"\",\n        lastName: \"\",\n        phoneNumber: \"\",\n        deliveryService: \"\",\n        poids: \"\"\n      },\n      errors: {\n        firstName: \"\",\n        lastName: \"\",\n        email: \"\",\n        phoneNumber: \"\",\n        deliveryService: \"\",\n        poids: \"\"\n      },\n      userType: localStorage.getItem('userType')\n    };\n  },\n  computed: {},\n  mounted() {\n    this.initPage();\n  },\n  methods: {\n    ...mapMutations({\n      logoutUser: \"auth/logout\"\n    }),\n    initPage() {\n      this.formData.firstName = localStorage.getItem('userFirst') || localStorage.getItem('delFirst');\n      this.formData.lastName = localStorage.getItem('userLast') || localStorage.getItem('delLast');\n      this.formData.email = localStorage.getItem('userEmail') || localStorage.getItem('delEmail');\n      this.formData.phoneNumber = localStorage.getItem('userPhone') || localStorage.getItem('delPhone');\n      this.formData.deliveryService = localStorage.getItem('delSiret');\n      this.formData.poids = localStorage.getItem('delPoids');\n    },\n    cancelEditing() {\n      this.isEditing = false;\n      this.initPage();\n    },\n    changeField(propertyName, value) {\n      if (this.errors[propertyName] !== \"\") {\n        this.errors[propertyName] = \"\";\n      }\n      this.formData[propertyName] = value;\n      this.formData.emailNotifications[propertyName] = value;\n    },\n    async saveChangeClick() {\n      try {\n        if (localStorage.getItem('userType') === 'User') {\n          const response = await axios.post('http://localhost:5000/user/update', {\n            email: localStorage.getItem('userEmail'),\n            firstName: this.formData.firstName,\n            lastName: this.formData.lastName,\n            phoneNumber: this.formData.phoneNumber\n          });\n          const userData = response.data.user;\n          localStorage.setItem('userFirst', this.formData.firstName);\n          localStorage.setItem('userLast', this.formData.lastName);\n          localStorage.setItem('userPhone', this.formData.phoneNumber);\n          localStorage.setItem('userType', 'User');\n          this.$router.push({\n            path: '/profile'\n          });\n        } else {\n          const response = await axios.post('http://localhost:5000/delivry/update', {\n            email: localStorage.getItem('delEmail'),\n            firstName: this.formData.firstName,\n            lastName: this.formData.lastName,\n            phoneNumber: this.formData.phoneNumber,\n            deliveryService: this.formData.deliveryService,\n            poids: this.formData.poids\n          });\n          localStorage.setItem('delEmail', this.formData.email);\n          localStorage.setItem('delFirst', this.formData.firstName);\n          localStorage.setItem('delLast', this.formData.lastName);\n          localStorage.setItem('delPhone', this.formData.phoneNumber);\n          localStorage.setItem('delSiret', this.formData.deliveryService);\n          localStorage.setItem('delPoids', this.formData.poids);\n          localStorage.setItem('userType', 'Del');\n          this.$router.push({\n            path: '/profile'\n          });\n        }\n      } catch (error) {\n        console.error(error);\n      }\n      this.isLoading = true;\n      setTimeout(() => {\n        this.isLoading = false;\n        this.isEditing = false;\n      }, 2500);\n    },\n    logout() {\n      this.logoutUser();\n      this.$router.push(\"/\");\n    }\n  }\n};","map":{"version":3,"mappings":";AA0FA;AACA;AACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAL;QACAC;QACAK;QACAJ;QACAC;QACAC;MACA;MACAG;IACA;EACA;EACAC,WACA;EACAC;IACA;EACA;EACAC;IACA;MACAC;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MAEA;MACA;IACA;IACA;MACA;QACA;UACA;YACAR;YACAN;YACAC;YACAC;UACA;UAEA;UACAa;UACAA;UACAA;UACAA;UACA;YAAAC;UAAA;QACA,OAEA;UACA;YACAV;YACAN;YACAC;YACAC;YACAC;YACAC;UACA;UACAW;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACA;YAAAC;UAAA;QACA;MAEA;QACAC;MACA;MACA;MAEAC;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;EACA;AACA","names":["name","data","isEditing","isLoading","formData","firstName","lastName","phoneNumber","deliveryService","poids","errors","email","userType","computed","mounted","methods","logoutUser","initPage","cancelEditing","changeField","localStorage","path","console","setTimeout","logout"],"sourceRoot":"src/pages/Profile","sources":["AccountPage.vue"],"sourcesContent":["<template>\n  <div v-if=\"userType != 'admin'\">\n    <h3 class=\"profile__name\">Account</h3>\n    <div class=\"account__info\">\n      <h2 class=\"account__title\">Personal information</h2>\n    \n      <div class=\"account__action\">\n      \n        <BaseButton\n          v-if=\"isEditing\"\n          class=\"account__btns-discardBtn\"\n          @onClick=\"cancelEditing\"\n        >\n          Cancel\n        </BaseButton>\n\n        <BaseButton\n          v-else\n          variant=\"primary-outline\"\n          @onClick=\"isEditing = true\"\n        >\n          Change\n        </BaseButton>\n      </div>\n\n      <div class=\"account__input\">\n        <BaseInput\n          label=\"First name\"\n          placeholder=\"Jane\"\n          :value=\"formData.firstName\"\n          :error=\"errors.firstName\"\n          :disabled=\"!isEditing || isLoading\"\n          @onInput=\"(value) => changeField('firstName', value)\"\n        />\n\n        <BaseInput\n          label=\"Last name\"\n          placeholder=\"Robertson\"\n          :value=\"formData.lastName\"\n          :error=\"errors.lastName\"\n          :disabled=\"!isEditing || isLoading\"\n          @onInput=\"(value) => changeField('lastName', value)\"\n        />\n        <div class=\"Delivery\" v-if=\"userType === 'Del'\">\n        <BaseInput label=\"Siret\" placeholder=\"803714100\" :disabled=\"!isEditing || isLoading\" :value=\"formData.deliveryService\" :error=\"errors.deliveryService\"\n          @onInput=\"(value) => changeField('deliveryService', value)\" />\n        <BaseInput label=\"Poids Max\" placeholder=\"120 kg\" :disabled=\"!isEditing || isLoading\" :value=\"formData.poids\" :error=\"errors.poids\"\n          @onInput=\"(value) => changeField('poids', value)\" />\n      </div>\n\n        <BaseInput\n          label=\"Phone number\"\n          placeholder=\"+998 (99) 324-42-91\"\n          :value=\"formData.phoneNumber\"\n          :error=\"errors.phoneNumber\"\n          :disabled=\"!isEditing || isLoading\"\n          @onInput=\"(value) => changeField('phoneNumber', value)\" \n        />\n        <BaseInput\n          label=\"New password\"\n          type=\"password\"\n          placeholder=\"***********\"\n          :value=\"formData.password\"\n          :error=\"errors.password\"\n          :disabled=\"!isEditing || isLoading\"\n          @onInput=\"(value) => changeField('password', value)\" \n        />\n       \n      </div>\n\n    \n\n      <div class=\"profile-form-divider\"></div>\n\n      <div class=\"account__btns\">\n        <div>\n          <BaseButton\n            v-if=\"isEditing\"\n            class=\"SaveBtn\"\n            @onClick=\"saveChangeClick\"\n            :loading=\"isLoading\"\n            >Save changes</BaseButton\n          >\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapMutations, mapGetters } from \"vuex\";\nimport axios from 'axios';\nexport default {\n  name: \"AccountPage\",\n  data() {\n    return {\n      isEditing: false,\n      isLoading: false,\n      formData: {\n        firstName: \"\",\n        lastName: \"\",\n        phoneNumber: \"\",\n        deliveryService: \"\",\n        poids: \"\",\n      },\n      errors: {\n        firstName: \"\",\n        lastName: \"\",\n        email: \"\",\n        phoneNumber: \"\",\n        deliveryService: \"\",\n        poids: \"\",\n      },\n      userType: localStorage.getItem('userType'),\n    };\n  },\n  computed: {\n  },\n  mounted() {\n    this.initPage();\n  },\n  methods: {\n    ...mapMutations({\n      logoutUser: \"auth/logout\",\n    }),\n    initPage() {\n      this.formData.firstName = localStorage.getItem('userFirst') || localStorage.getItem('delFirst') ;\n      this.formData.lastName = localStorage.getItem('userLast') || localStorage.getItem('delLast') ;\n      this.formData.email = localStorage.getItem('userEmail') || localStorage.getItem('delEmail') ;\n      this.formData.phoneNumber = localStorage.getItem('userPhone') || localStorage.getItem('delPhone') ;\n      this.formData.deliveryService = localStorage.getItem('delSiret');\n      this.formData.poids = localStorage.getItem('delPoids');\n    },\n    cancelEditing() {\n      this.isEditing = false;\n      this.initPage();\n    },\n    changeField(propertyName, value) {\n      if (this.errors[propertyName] !== \"\") {\n        this.errors[propertyName] = \"\";\n      }\n\n      this.formData[propertyName] = value;\n      this.formData.emailNotifications[propertyName] = value;\n    },\n    async saveChangeClick() {\n      try {\n        if (localStorage.getItem('userType') === 'User') {\n          const response = await axios.post('http://localhost:5000/user/update', {\n          email: localStorage.getItem('userEmail'),\n          firstName: this.formData.firstName,\n          lastName: this.formData.lastName,\n          phoneNumber: this.formData.phoneNumber,\n        });      \n         \n          const userData = response.data.user;\n          localStorage.setItem('userFirst', this.formData.firstName);\n          localStorage.setItem('userLast', this.formData.lastName);\n          localStorage.setItem('userPhone', this.formData.phoneNumber);\n          localStorage.setItem('userType', 'User');\n          this.$router.push({ path: '/profile' });\n         }\n\n        else {\n          const response = await axios.post('http://localhost:5000/delivry/update', {\n          email: localStorage.getItem('delEmail'),\n          firstName: this.formData.firstName,\n          lastName: this.formData.lastName,\n          phoneNumber: this.formData.phoneNumber,\n          deliveryService: this.formData.deliveryService,\n          poids: this.formData.poids,\n        });   \n          localStorage.setItem('delEmail', this.formData.email);\n          localStorage.setItem('delFirst', this.formData.firstName);\n          localStorage.setItem('delLast', this.formData.lastName);\n          localStorage.setItem('delPhone', this.formData.phoneNumber);\n          localStorage.setItem('delSiret', this.formData.deliveryService);\n          localStorage.setItem('delPoids', this.formData.poids);\n          localStorage.setItem('userType', 'Del');\n          this.$router.push({ path: '/profile' });\n           }\n\n      } catch (error) {\n        console.error(error);\n      }\n      this.isLoading = true;\n\n      setTimeout(() => {\n        this.isLoading = false;\n        this.isEditing = false;\n      }, 2500);\n    },\n    logout() {\n      this.logoutUser();\n      this.$router.push(\"/\");\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.account {\n  &__info {\n    background: $color-white;\n    border: 1px solid $color-grey-lightest;\n    border-radius: 16px;\n    padding: 16px;\n    margin-bottom: 24px;\n    // height: 100vh;\n  }\n\n  &__title {\n    font-family: $base-font;\n    font-weight: 700;\n    font-size: 18px;\n    line-height: 24px;\n    letter-spacing: 0.1px;\n    margin-bottom: 16px;\n    color: $color-dark;\n  }\n\n  &__text {\n    font-family: $base-font;\n    font-weight: 600;\n    font-size: 12px;\n    line-height: 16px;\n    margin-bottom: 8px;\n    color: $color-grey-dark;\n  }\n\n  &__action {\n    display: flex;\n    align-items: center;\n    margin-bottom: 16px;\n  }\n\n  &__img {\n    cursor: pointer;\n    border-radius: 12px;\n    margin-right: 24px;\n    width: 76px;\n    height: 76px;\n  }\n\n  &__input {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 16px;\n    margin-bottom: 15px;\n  }\n\n  &__btns {\n    display: flex;\n    justify-content: space-between;\n\n    &-discardBtn {\n      margin-right: 16px;\n    }\n\n    .SaveBtn {\n      min-width: 120px;\n    }\n  }\n}\n\n.profile-notifications {\n  &__wrapper {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 24px 16px;\n    margin-bottom: 36px;\n  }\n}\n\n.profile-form-divider {\n  margin-top: 20px;\n  margin-bottom: 20px;\n  height: 1px;\n  width: 100%;\n  background-color: $color-grey-light;\n}\n\n@media screen and (max-width: 768px) {\n  .account {\n    &__input {\n      grid-template-columns: 1fr;\n    }\n\n    &__btns {\n      flex-direction: column;\n\n      div {\n        &:nth-child(2) {\n          display: flex;\n          justify-content: space-between;\n        }\n\n        button {\n          width: 100%;\n        }\n      }\n\n      &-dangerBtn {\n        margin-bottom: 40px;\n      }\n    }\n  }\n\n  .profile-notifications {\n    &__wrapper {\n      grid-template-columns: 1fr;\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}