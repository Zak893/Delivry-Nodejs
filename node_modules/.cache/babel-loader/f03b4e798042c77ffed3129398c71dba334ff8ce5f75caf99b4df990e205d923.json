{"ast":null,"code":"import axios from 'axios';\nexport default {\n  name: \"MyOrdersPage\",\n  data() {\n    return {\n      orders: [],\n      // Array pour stocker les commandes\n      selectedRates: {} // Object to store the selected rate for each order\n    };\n  },\n\n  mounted() {\n    this.fetchOrders(); // Appeler la méthode pour récupérer les commandes au chargement du composant\n  },\n\n  methods: {\n    async fetchOrders() {\n      const userEmail = localStorage.getItem('userEmail'); // Récupérer l'e-mail de l'utilisateur depuis localStorage\n      try {\n        const response = await axios.get(`/get-orders?email=${userEmail}`); // Remplacez par l'URL correcte pour récupérer les commandes\n        console.log(response.data.orders);\n        this.orders = response.data.orders; // Mettre à jour le tableau des commandes avec les données récupérées\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async saveRate(index) {\n      try {\n        const orderToUpdate = this.orders[index];\n        const selectedRate = this.selectedRates[index];\n        const response = await axios.put(`/update-order-rate/${orderToUpdate._id}`, {\n          rate: selectedRate\n        });\n\n        // Update the rate in the local data\n        orderToUpdate.rate = selectedRate;\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  }\n};","map":{"version":3,"mappings":"AAuDA;AACA;EACAA;EACAC;IACA;MACAC;MAAA;MACAC;IAEA;EACA;;EACAC;IACA;EACA;;EACAC;IACA;MACA;MACA;QAEA;QACAC;QACA;MACA;QACAA;MACA;IACA;IACA;MACA;QACA;QACA;QAEA;UACAC;QACA;;QAEA;QACAC;MACA;QACAF;MACA;IACA;EACA;AACA","names":["name","data","orders","selectedRates","mounted","methods","console","rate","orderToUpdate"],"sourceRoot":"src/pages","sources":["MyOrdersPage.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h2 class=\"my-orders__heading\">My Orders</h2>\n\n    <div class=\"my-orders__content\">\n      <h3 class=\"my-orders__content-title\">Orders list</h3>\n      <div id=\"app\">\n      <table>\n        <thead>\n            <tr>\n              <th>Order ID</th>\n              <th>Weight</th>\n               <th>Delivery address</th>\n               <th>Delivery name</th>\n              <th>Rate /10</th>\n            </tr>\n        </thead>\n        <tbody>\n          <tr v-if=\"orders.length > 0\" v-for=\"(order, index) in orders\" :key=\"index\">\n            <td>{{index + 1}}</td>\n              <td>{{ order.poids }}</td>\n              <td>{{ order.adress+' '+order.complement+' '+order.postal }}</td>\n              <td v-if=\"order.Del != null\">{{ order.Del }} brings your order back to you</td>\n              <td v-if=\"order.Del == null\">please wait for a delivery person to take your order...</td>\n            <td v-if=\"order.Del != null || order.rate == 0\">\n              <select v-model=\"selectedRates[index]\" >\n                <option>1</option>\n                <option>2</option>\n                <option>3</option>\n                <option>4</option>\n                <option>5</option>\n                <option>6</option>\n                <option>7</option>\n                <option>8</option>\n                <option>9</option>\n                <option>10</option>\n              </select>\n            </td>\n            <td v-if=\"order.Del != null && order.rate == 0\"><button @click=\"saveRate(index)\">\n  Save\n</button></td>\n<td v-if=\"order.Del != null || order.rate == 0\">{{ order.rate }}</td>\n          </tr>\n          <tr v-if=\"orders.length == 0\">\n              <td colspan=\"5\">No orders available.</td>\n            </tr>\n        </tbody>\n      </table>\n  \n    </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nexport default {\n  name: \"MyOrdersPage\",\n  data() {\n    return {\n      orders: [], // Array pour stocker les commandes\n      selectedRates: {}, // Object to store the selected rate for each order\n\n    };\n  },\n  mounted() {\n    this.fetchOrders(); // Appeler la méthode pour récupérer les commandes au chargement du composant\n  },\n  methods: {\n    async fetchOrders() {\n      const userEmail = localStorage.getItem('userEmail'); // Récupérer l'e-mail de l'utilisateur depuis localStorage\n      try {\n        \n        const response = await axios.get(`/get-orders?email=${userEmail}`); // Remplacez par l'URL correcte pour récupérer les commandes\n        console.log(response.data.orders)\n        this.orders = response.data.orders; // Mettre à jour le tableau des commandes avec les données récupérées\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async saveRate(index) {\n    try {\n      const orderToUpdate = this.orders[index];\n      const selectedRate = this.selectedRates[index];\n\n      const response = await axios.put(`/update-order-rate/${orderToUpdate._id}`, {\n        rate: selectedRate,\n      });\n\n      // Update the rate in the local data\n      orderToUpdate.rate = selectedRate;\n    } catch (error) {\n      console.error(error);\n    }\n  },\n  }\n};\n\n\n</script>\n\n<style lang=\"scss\">\n.my-orders {\n  &__heading {\n    color: $color-dark;\n    font-size: 20px;\n    font-family: $base-font;\n    font-weight: 600;\n    line-height: 28px;\n    letter-spacing: 0.1px;\n    margin-bottom: 16px;\n  }\n\n  &__content {\n    border: 1px solid $color-grey-lightest;\n    border-radius: 16px;\n    padding: 16px;\n    margin-bottom: 24px;\n  }\n\n  &__content-title {\n    color: $color-dark;\n    font-family: $base-font;\n    font-weight: 700;\n    font-size: 18px;\n    line-height: 24px;\n    letter-spacing: 0.1px;\n    margin-bottom: 16px;\n  }\n}\ntable , tr,td , th{\n  border: 1px solid black;\n  padding: 10px;\n}\nbutton.newItem {\n  padding: 5px;\n  margin: 14px 0 0 0;\n  font-weight: bold;\n  font-size: 16px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}